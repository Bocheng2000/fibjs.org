<!DOCTYPE html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="initial-scale=1,maximum-scale=1,user-scalable=no"><link rel=icon type=image/png href=../../imgs/icon.png><title> fibjs 中 X509 证书的使用 - JavaScript on Fiber</title><link href=../../css/common.css rel=stylesheet><link href=../../css/docs.css rel=stylesheet></head><body><div class="navbar navbar-default navbar-static-top" role=navigation><div class=container><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#navbar aria-expanded=false aria-controls=navbar><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href=../../index.html><img src=../../imgs/logo-dark.png></a></div><div id=navbar class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right notranslate"><li><a href=../../index.html>HOME</a></li><li><a href=readme.md.html>GUIDE</a></li><li><a href=../manual/module/readme.md.html>MODULE</a></li><li><a href=../manual/object/readme.md.html>OBJECT</a></li><li><a href=../awesome/readme.md.html>AWESOME</a></li><li><a href=../../download/index.html>DOWNLOAD</a></li><li class="nav-item dropdown"><a href=# data-toggle=dropdown aria-haspopup=true aria-expanded=false>LANGUAGE</a><div class=dropdown-menu><a href=../../docs/guide/x509.md.html>中文</a> <a href=../../ca/docs/guide/x509.md.html>Catalan</a> <a href=../../de/docs/guide/x509.md.html>Deutsch</a> <a href=../../en/docs/guide/x509.md.html>English</a> <a href=../../es/docs/guide/x509.md.html>Español</a> <a href=../../fr/docs/guide/x509.md.html>Français</a> <a href=../../gl/docs/guide/x509.md.html>Galego</a> <a href=../../it/docs/guide/x509.md.html>Italiano</a> <a href=../../nl/docs/guide/x509.md.html>Nederlands</a> <a href=../../ru/docs/guide/x509.md.html>Русский</a> <a href=../../ja/docs/guide/x509.md.html>日本語</a> <a href=../../ko/docs/guide/x509.md.html>한국어</a> <a href=../../zh-tw/docs/guide/x509.md.html>繁體中文</a></div></li></ul></div></div></div><div class=band><div class=container><span class=group> Guide 开发指南 </span><div class=search><input type=text class=searchbox placeholder=Search></div></div></div><div class=container><ol class=breadcrumb><li><a href=../../index.html>首页</a></li><li><a href=readme.md.html> 开发指南 </a></li><li class=active> fibjs 中 X509 证书的使用 </li></ol></div><div class=page-body><div class=container><div class="sidebar hidden-xs"><div class=panel-group id=accordion role=tablist>  <div class=panel><div class=panel-heading role=tab id=headingOne><h4 class=panel-title><a data-toggle=collapse data-parent=#accordion href="#collapse_guide" aria-controls="collapse_guide"> 开发指南 </a></h4></div><div id="collapse_guide" class="panel-collapse collapse in" aria-labelledby=headingOne><div class=panel-body> <ul>
<li><a href=about.md.html>fibjs 是什么？</a></li>
<li><a href=install.md.html>安装运行环境</a></li>
<li><a href=hello.md.html class ="notranslate">hello, world</a></li>
<li><a href=test.md.html>美好生活从测试开始</a></li>
<li><a href=profiler.md.html>找出性能杀手</a></li>
<li><a href=sync.md.html>同步和异步</a></li>
<li><a href=server-hot-update.md.html>服务端模块热更新</a></li>
<li><a href=web.md.html>高性能 Web 应用程序实践</a></li>
<li><a href=host-routes.md.html>域名路由</a></li>
<li class="active"><a href=x509.md.html>fibjs 中 X509 证书的使用</a></li>
<li><a href=contribute.md.html>添加 native 模块</a></li>
</ul>
 </div></div></div>  <div class=panel><div class=panel-heading role=tab id=headingOne><h4 class=panel-title><a data-toggle=collapse data-parent=#accordion href="#collapse_module" aria-controls="collapse_module"> 基础模块 </a></h4></div><div id="collapse_module" class="panel-collapse collapse " aria-labelledby=headingOne><div class=panel-body> <ul>
<li><a href=../manual/module/ifs/assert.md.html class ="notranslate">assert</a></li>
<li><a href=../manual/module/ifs/base32.md.html class ="notranslate">base32</a></li>
<li><a href=../manual/module/ifs/base58.md.html class ="notranslate">base58</a></li>
<li><a href=../manual/module/ifs/base64.md.html class ="notranslate">base64</a></li>
<li><a href=../manual/module/ifs/child_process.md.html class ="notranslate">child_process</a></li>
<li><a href=../manual/module/ifs/console.md.html class ="notranslate">console</a></li>
<li><a href=../manual/module/ifs/constants.md.html class ="notranslate">constants</a></li>
<li><a href=../manual/module/ifs/coroutine.md.html class ="notranslate">coroutine</a></li>
<li><a href=../manual/module/ifs/crypto.md.html class ="notranslate">crypto</a></li>
<li><a href=../manual/module/ifs/db.md.html class ="notranslate">db</a></li>
<li><a href=../manual/module/ifs/dgram.md.html class ="notranslate">dgram</a></li>
<li><a href=../manual/module/ifs/dns.md.html class ="notranslate">dns</a></li>
<li><a href=../manual/module/ifs/encoding.md.html class ="notranslate">encoding</a></li>
<li><a href=../manual/module/ifs/fs.md.html class ="notranslate">fs</a></li>
<li><a href=../manual/module/ifs/fs_constants.md.html class ="notranslate">fs_constants</a></li>
<li><a href=../manual/module/ifs/gd.md.html class ="notranslate">gd</a></li>
<li><a href=../manual/module/ifs/global.md.html class ="notranslate">global</a></li>
<li><a href=../manual/module/ifs/gui.md.html class ="notranslate">gui</a></li>
<li><a href=../manual/module/ifs/hash.md.html class ="notranslate">hash</a></li>
<li><a href=../manual/module/ifs/hex.md.html class ="notranslate">hex</a></li>
<li><a href=../manual/module/ifs/http.md.html class ="notranslate">http</a></li>
<li><a href=../manual/module/ifs/iconv.md.html class ="notranslate">iconv</a></li>
<li><a href=../manual/module/ifs/io.md.html class ="notranslate">io</a></li>
<li><a href=../manual/module/ifs/json.md.html class ="notranslate">json</a></li>
<li><a href=../manual/module/ifs/mq.md.html class ="notranslate">mq</a></li>
<li><a href=../manual/module/ifs/msgpack.md.html class ="notranslate">msgpack</a></li>
<li><a href=../manual/module/ifs/multibase.md.html class ="notranslate">multibase</a></li>
<li><a href=../manual/module/ifs/net.md.html class ="notranslate">net</a></li>
<li><a href=../manual/module/ifs/os.md.html class ="notranslate">os</a></li>
<li><a href=../manual/module/ifs/path.md.html class ="notranslate">path</a></li>
<li><a href=../manual/module/ifs/path_posix.md.html class ="notranslate">path_posix</a></li>
<li><a href=../manual/module/ifs/path_win32.md.html class ="notranslate">path_win32</a></li>
<li><a href=../manual/module/ifs/perf_hooks.md.html class ="notranslate">perf_hooks</a></li>
<li><a href=../manual/module/ifs/performance.md.html class ="notranslate">performance</a></li>
<li><a href=../manual/module/ifs/process.md.html class ="notranslate">process</a></li>
<li><a href=../manual/module/ifs/profiler.md.html class ="notranslate">profiler</a></li>
<li><a href=../manual/module/ifs/punycode.md.html class ="notranslate">punycode</a></li>
<li><a href=../manual/module/ifs/querystring.md.html class ="notranslate">querystring</a></li>
<li><a href=../manual/module/ifs/registry.md.html class ="notranslate">registry</a></li>
<li><a href=../manual/module/ifs/ssl.md.html class ="notranslate">ssl</a></li>
<li><a href=../manual/module/ifs/string_decoder.md.html class ="notranslate">string_decoder</a></li>
<li><a href=../manual/module/ifs/test.md.html class ="notranslate">test</a></li>
<li><a href=../manual/module/ifs/timers.md.html class ="notranslate">timers</a></li>
<li><a href=../manual/module/ifs/tty.md.html class ="notranslate">tty</a></li>
<li><a href=../manual/module/ifs/url.md.html class ="notranslate">url</a></li>
<li><a href=../manual/module/ifs/util.md.html class ="notranslate">util</a></li>
<li><a href=../manual/module/ifs/uuid.md.html class ="notranslate">uuid</a></li>
<li><a href=../manual/module/ifs/vm.md.html class ="notranslate">vm</a></li>
<li><a href=../manual/module/ifs/worker_threads.md.html class ="notranslate">worker_threads</a></li>
<li><a href=../manual/module/ifs/ws.md.html class ="notranslate">ws</a></li>
<li><a href=../manual/module/ifs/xml.md.html class ="notranslate">xml</a></li>
<li><a href=../manual/module/ifs/zip.md.html class ="notranslate">zip</a></li>
<li><a href=../manual/module/ifs/zlib.md.html class ="notranslate">zlib</a></li>
</ul>
 </div></div></div>  <div class=panel><div class=panel-heading role=tab id=headingOne><h4 class=panel-title><a data-toggle=collapse data-parent=#accordion href="#collapse_object" aria-controls="collapse_object"> 内置对象 </a></h4></div><div id="collapse_object" class="panel-collapse collapse " aria-labelledby=headingOne><div class=panel-body> <ul>
<li><a href=../manual/object/ifs/blskey.md.html class ="notranslate">BlsKey</a></li>
<li><a href=../manual/object/ifs/buffer.md.html class ="notranslate">Buffer</a></li>
<li><a href=../manual/object/ifs/bufferedstream.md.html class ="notranslate">BufferedStream</a></li>
<li><a href=../manual/object/ifs/chain.md.html class ="notranslate">Chain</a></li>
<li><a href=../manual/object/ifs/childprocess.md.html class ="notranslate">ChildProcess</a></li>
<li><a href=../manual/object/ifs/cipher.md.html class ="notranslate">Cipher</a></li>
<li><a href=../manual/object/ifs/condition.md.html class ="notranslate">Condition</a></li>
<li><a href=../manual/object/ifs/dbconnection.md.html class ="notranslate">DbConnection</a></li>
<li><a href=../manual/object/ifs/dgramsocket.md.html class ="notranslate">DgramSocket</a></li>
<li><a href=../manual/object/ifs/digest.md.html class ="notranslate">Digest</a></li>
<li><a href=../manual/object/ifs/eckey.md.html class ="notranslate">ECKey</a></li>
<li><a href=../manual/object/ifs/ed25519key.md.html class ="notranslate">Ed25519Key</a></li>
<li><a href=../manual/object/ifs/event.md.html class ="notranslate">Event</a></li>
<li><a href=../manual/object/ifs/eventemitter.md.html class ="notranslate">EventEmitter</a></li>
<li><a href=../manual/object/ifs/fswatcher.md.html class ="notranslate">FSWatcher</a></li>
<li><a href=../manual/object/ifs/fiber.md.html class ="notranslate">Fiber</a></li>
<li><a href=../manual/object/ifs/file.md.html class ="notranslate">File</a></li>
<li><a href=../manual/object/ifs/handler.md.html class ="notranslate">Handler</a></li>
<li><a href=../manual/object/ifs/heapgraphedge.md.html class ="notranslate">HeapGraphEdge</a></li>
<li><a href=../manual/object/ifs/heapgraphnode.md.html class ="notranslate">HeapGraphNode</a></li>
<li><a href=../manual/object/ifs/heapsnapshot.md.html class ="notranslate">HeapSnapshot</a></li>
<li><a href=../manual/object/ifs/httpclient.md.html class ="notranslate">HttpClient</a></li>
<li><a href=../manual/object/ifs/httpcollection.md.html class ="notranslate">HttpCollection</a></li>
<li><a href=../manual/object/ifs/httpcookie.md.html class ="notranslate">HttpCookie</a></li>
<li><a href=../manual/object/ifs/httphandler.md.html class ="notranslate">HttpHandler</a></li>
<li><a href=../manual/object/ifs/httpmessage.md.html class ="notranslate">HttpMessage</a></li>
<li><a href=../manual/object/ifs/httprepeater.md.html class ="notranslate">HttpRepeater</a></li>
<li><a href=../manual/object/ifs/httprequest.md.html class ="notranslate">HttpRequest</a></li>
<li><a href=../manual/object/ifs/httpresponse.md.html class ="notranslate">HttpResponse</a></li>
<li><a href=../manual/object/ifs/httpserver.md.html class ="notranslate">HttpServer</a></li>
<li><a href=../manual/object/ifs/httpuploaddata.md.html class ="notranslate">HttpUploadData</a></li>
<li><a href=../manual/object/ifs/httpsserver.md.html class ="notranslate">HttpsServer</a></li>
<li><a href=../manual/object/ifs/image.md.html class ="notranslate">Image</a></li>
<li><a href=../manual/object/ifs/iterator.md.html class ="notranslate">Iterator</a></li>
<li><a href=../manual/object/ifs/leveldb.md.html class ="notranslate">LevelDB</a></li>
<li><a href=../manual/object/ifs/lock.md.html class ="notranslate">Lock</a></li>
<li><a href=../manual/object/ifs/lrucache.md.html class ="notranslate">LruCache</a></li>
<li><a href=../manual/object/ifs/memorystream.md.html class ="notranslate">MemoryStream</a></li>
<li><a href=../manual/object/ifs/message.md.html class ="notranslate">Message</a></li>
<li><a href=../manual/object/ifs/mongocollection.md.html class ="notranslate">MongoCollection</a></li>
<li><a href=../manual/object/ifs/mongocursor.md.html class ="notranslate">MongoCursor</a></li>
<li><a href=../manual/object/ifs/mongodb.md.html class ="notranslate">MongoDB</a></li>
<li><a href=../manual/object/ifs/mongoid.md.html class ="notranslate">MongoID</a></li>
<li><a href=../manual/object/ifs/mysql.md.html class ="notranslate">MySQL</a></li>
<li><a href=../manual/object/ifs/odbc.md.html class ="notranslate">Odbc</a></li>
<li><a href=../manual/object/ifs/pkey.md.html class ="notranslate">PKey</a></li>
<li><a href=../manual/object/ifs/rangestream.md.html class ="notranslate">RangeStream</a></li>
<li><a href=../manual/object/ifs/redis.md.html class ="notranslate">Redis</a></li>
<li><a href=../manual/object/ifs/redishash.md.html class ="notranslate">RedisHash</a></li>
<li><a href=../manual/object/ifs/redislist.md.html class ="notranslate">RedisList</a></li>
<li><a href=../manual/object/ifs/redisset.md.html class ="notranslate">RedisSet</a></li>
<li><a href=../manual/object/ifs/redissortedset.md.html class ="notranslate">RedisSortedSet</a></li>
<li><a href=../manual/object/ifs/routing.md.html class ="notranslate">Routing</a></li>
<li><a href=../manual/object/ifs/sqlite.md.html class ="notranslate">SQLite</a></li>
<li><a href=../manual/object/ifs/sandbox.md.html class ="notranslate">SandBox</a></li>
<li><a href=../manual/object/ifs/seekablestream.md.html class ="notranslate">SeekableStream</a></li>
<li><a href=../manual/object/ifs/semaphore.md.html class ="notranslate">Semaphore</a></li>
<li><a href=../manual/object/ifs/service.md.html class ="notranslate">Service</a></li>
<li><a href=../manual/object/ifs/smtp.md.html class ="notranslate">Smtp</a></li>
<li><a href=../manual/object/ifs/socket.md.html class ="notranslate">Socket</a></li>
<li><a href=../manual/object/ifs/sslhandler.md.html class ="notranslate">SslHandler</a></li>
<li><a href=../manual/object/ifs/sslserver.md.html class ="notranslate">SslServer</a></li>
<li><a href=../manual/object/ifs/sslsocket.md.html class ="notranslate">SslSocket</a></li>
<li><a href=../manual/object/ifs/stat.md.html class ="notranslate">Stat</a></li>
<li><a href=../manual/object/ifs/statswatcher.md.html class ="notranslate">StatsWatcher</a></li>
<li><a href=../manual/object/ifs/stream.md.html class ="notranslate">Stream</a></li>
<li><a href=../manual/object/ifs/stringdecoder.md.html class ="notranslate">StringDecoder</a></li>
<li><a href=../manual/object/ifs/ttyinputstream.md.html class ="notranslate">TTYInputStream</a></li>
<li><a href=../manual/object/ifs/ttyoutputstream.md.html class ="notranslate">TTYOutputStream</a></li>
<li><a href=../manual/object/ifs/tcpserver.md.html class ="notranslate">TcpServer</a></li>
<li><a href=../manual/object/ifs/textdecoder.md.html class ="notranslate">TextDecoder</a></li>
<li><a href=../manual/object/ifs/textencoder.md.html class ="notranslate">TextEncoder</a></li>
<li><a href=../manual/object/ifs/timer.md.html class ="notranslate">Timer</a></li>
<li><a href=../manual/object/ifs/urlobject.md.html class ="notranslate">UrlObject</a></li>
<li><a href=../manual/object/ifs/websocket.md.html class ="notranslate">WebSocket</a></li>
<li><a href=../manual/object/ifs/websocketmessage.md.html class ="notranslate">WebSocketMessage</a></li>
<li><a href=../manual/object/ifs/webview.md.html class ="notranslate">WebView</a></li>
<li><a href=../manual/object/ifs/worker.md.html class ="notranslate">Worker</a></li>
<li><a href=../manual/object/ifs/x509cert.md.html class ="notranslate">X509Cert</a></li>
<li><a href=../manual/object/ifs/x509crl.md.html class ="notranslate">X509Crl</a></li>
<li><a href=../manual/object/ifs/x509req.md.html class ="notranslate">X509Req</a></li>
<li><a href=../manual/object/ifs/xmlattr.md.html class ="notranslate">XmlAttr</a></li>
<li><a href=../manual/object/ifs/xmlcdatasection.md.html class ="notranslate">XmlCDATASection</a></li>
<li><a href=../manual/object/ifs/xmlcharacterdata.md.html class ="notranslate">XmlCharacterData</a></li>
<li><a href=../manual/object/ifs/xmlcomment.md.html class ="notranslate">XmlComment</a></li>
<li><a href=../manual/object/ifs/xmldocument.md.html class ="notranslate">XmlDocument</a></li>
<li><a href=../manual/object/ifs/xmldocumenttype.md.html class ="notranslate">XmlDocumentType</a></li>
<li><a href=../manual/object/ifs/xmlelement.md.html class ="notranslate">XmlElement</a></li>
<li><a href=../manual/object/ifs/xmlnamednodemap.md.html class ="notranslate">XmlNamedNodeMap</a></li>
<li><a href=../manual/object/ifs/xmlnode.md.html class ="notranslate">XmlNode</a></li>
<li><a href=../manual/object/ifs/xmlnodelist.md.html class ="notranslate">XmlNodeList</a></li>
<li><a href=../manual/object/ifs/xmlprocessinginstruction.md.html class ="notranslate">XmlProcessingInstruction</a></li>
<li><a href=../manual/object/ifs/xmltext.md.html class ="notranslate">XmlText</a></li>
<li><a href=../manual/object/ifs/zipfile.md.html class ="notranslate">ZipFile</a></li>
<li><a href=../manual/object/ifs/object.md.html class ="notranslate">object</a></li>
</ul>
 </div></div></div>  <div class=panel><div class=panel-heading role=tab id=headingOne><h4 class=panel-title><a data-toggle=collapse data-parent=#accordion href="#collapse_awesome" aria-controls="collapse_awesome"> 社区模块 </a></h4></div><div id="collapse_awesome" class="panel-collapse collapse " aria-labelledby=headingOne><div class=panel-body> <ul>
<li><a href=../awesome/module/fib-session.md.html class ="notranslate">fib-session</a></li>
<li><a href=../awesome/module/fib-pool.md.html class ="notranslate">fib-pool</a></li>
<li><a href=../awesome/module/fib-orm.md.html class ="notranslate">fib-orm</a></li>
<li><a href=../awesome/module/fib-app.md.html class ="notranslate">fib-app</a></li>
<li><a href=../awesome/module/fib-kv.md.html class ="notranslate">fib-kv</a></li>
<li><a href=../awesome/module/fib-rpc.md.html class ="notranslate">fib-rpc</a></li>
<li><a href=../awesome/module/fib-qr.md.html class ="notranslate">fib-qr</a></li>
<li><a href=../awesome/module/fib-pug.md.html class ="notranslate">fib-pug</a></li>
<li><a href=../awesome/module/ejs.md.html class ="notranslate">ejs</a></li>
<li><a href=../awesome/module/juicer.md.html class ="notranslate">Juicer</a></li>
<li><a href=../awesome/module/highlight.js.md.html class ="notranslate">highlight.js</a></li>
<li><a href=../awesome/module/marked.md.html class ="notranslate">marked</a></li>
<li><a href=../awesome/module/node-cron.md.html class ="notranslate">node-cron</a></li>
<li><a href=../awesome/module/debug.md.html class ="notranslate">debug</a></li>
<li><a href=../awesome/module/benchmark.js.md.html class ="notranslate">benchmark.js</a></li>
<li><a href=../awesome/module/sinon.md.html class ="notranslate">sinon</a></li>
<li><a href=../awesome/module/node-mime.md.html class ="notranslate">node-mime</a></li>
<li><a href=../awesome/module/validatorjs.md.html class ="notranslate">validatorjs</a></li>
<li><a href=../awesome/module/superstruct.md.html class ="notranslate">superstruct</a></li>
<li><a href=../awesome/module/cluster-server.md.html class ="notranslate">cluster-server</a></li>
<li><a href=../awesome/module/synaptic.md.html class ="notranslate">synaptic</a></li>
<li><a href=../awesome/module/source-map.md.html class ="notranslate">source-map</a></li>
<li><a href=../awesome/module/json-format.md.html class ="notranslate">json-format</a></li>
<li><a href=../awesome/module/viz.js.md.html class ="notranslate">viz.js</a></li>
<li><a href=../awesome/module/nomnoml.md.html class ="notranslate">nomnoml</a></li>
<li><a href=../awesome/module/pegjs.md.html class ="notranslate">pegjs</a></li>
<li><a href=../awesome/module/uglify-js.md.html class ="notranslate">uglify-js</a></li>
<li><a href=../awesome/module/js-beautify.md.html class ="notranslate">js-beautify</a></li>
<li><a href=../awesome/module/chalk-animation.md.html class ="notranslate">chalk-animation</a></li>
<li><a href=../awesome/module/jsrsasign.md.html class ="notranslate">jsrsasign</a></li>
<li><a href=../awesome/module/crypto-js.md.html class ="notranslate">crypto-js</a></li>
<li><a href=../awesome/module/ascii-table.md.html class ="notranslate">ascii-table</a></li>
<li><a href=../awesome/module/logstream.md.html class ="notranslate">logstream</a></li>
<li><a href=../awesome/module/ci.md.html class ="notranslate">ci</a></li>
<li><a href=../awesome/module/fs-readdir-recursive.md.html class ="notranslate">fs-readdir-recursive</a></li>
<li><a href=../awesome/module/mkdirp.md.html class ="notranslate">mkdirp</a></li>
<li><a href=../awesome/module/rmdirr.md.html class ="notranslate">rmdirr</a></li>
<li><a href=../awesome/module/detect-port.md.html class ="notranslate">detect-port</a></li>
<li><a href=../awesome/module/bitcoinjs-lib.md.html class ="notranslate">bitcoinjs-lib</a></li>
<li><a href=../awesome/module/rakuten.md.html class ="notranslate">Rakuten</a></li>
</ul>
 </div></div></div>  </div></div><div class=content><div class=social-share data-sites=weibo,twitter data-description=分享></div> <h1 id="fibjs-中-X509-证书的使用">fibjs 中 X509 证书的使用</h1>
<h2 id="背景介绍">背景介绍</h2>
<h3 id="什么是-x509-证书">什么是 x509 证书</h3>
<p>x509 证书是基于国际标准的公钥认证服务（PKI）体系中，最常用的一种数字证书格式。它能够用于认证和加密，在互联网上广泛应用于 SSL/TLS 协议以及其他类型的网络应用。x509 证书采用了公钥/私钥认证机制，并且能够保证数据传输的保密性、完整性和真实性等。</p>
<h3 id="x509-证书在什么场景中用到">x509 证书在什么场景中用到</h3>
<p>在互联网上，x509 证书最常用的场景是用于 TLS/SSL 协议中的证书认证，保证客户端与服务端之间传输的数据使用安全通道进行加密并且是经过验证的。x509 证书还可以用于 VPN/SSH 等基于公私钥加密的应用协议中的身份认证。</p>
<h3 id="fibjs-支持-x509-证书的处理">fibjs 支持 x509 证书的处理</h3>
<p>fibjs 支持 x509 证书的处理，提供了 crypto 模块中的 X509Cert、X509Req 等类来进行证书的读取、创建和签名等操作。可以通过这些类获取证书的有效期、公钥、颁发者、主题名称等信息，以及对证书进行签名、验证等操作。同时，fibjs 还提供了 HttpsServer 类来支持 HTTPS 的证书认证和加密连接，使得在 fibjs 中使用 x509 证书变得更加容易。</p>
<h2 id="X509-模块的介绍">X509 模块的介绍</h2>
<h3 id="X509-模块是什么">X509 模块是什么</h3>
<p>在 fibjs 的 crypto 模块中，提供了 X509Cert、X509Req 等类来进行 x509 证书的读取、创建和签名等操作。X509 模块是一个用于处理 x509 证书的模块，提供了对证书的解析、创建和验证等操作。</p>
<h3 id="X509-模块的作用">X509 模块的作用</h3>
<p>X509 模块的作用是对 x509 证书进行操作，可以通过该模块读取已有的 x509 证书，获取证书的有效期、公钥、颁发者、主题名称等信息。同时, X509 模块也可以创建 x509 证书请求和签名证书，方式如用于 TLS/SSL 协议中的证书认证。</p>
<h3 id="X509-模块的-API">X509 模块的 API</h3>
<p>以下是 X509 模块中比较重要的 API 列表：</p>
<ul>
<li><span class="notranslate">X509Cert</span>: 用于读取和操作 x509 证书的类。</li>
<li><span class="notranslate">X509Req</span>: 用于创建 x509 证书请求的类。</li>
<li><span class="notranslate">verify</span>: 通过 CA 证书对验证 x509 证书。</li>
<li><span class="notranslate">SslServer</span>: 提供基于 x509 证书的认证服务的类。</li>
<li><span class="notranslate">SslSocket</span>: 提供基于 x509 证书的认证服务的套接字收发数据操作的类。</li>
</ul>
<h3 id="示例代码">示例代码</h3>
<p>以下是读取 x509 证书和创建 x509 证书请求的示例代码：</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7
8
9
10
11
12</div><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto'</span>);

<span class="hljs-comment">// load the cert</span>
<span class="hljs-keyword">const</span> cert = crypto.loadCert(<span class="hljs-string">'server.crt'</span>);
<span class="hljs-built_in">console</span>.log(cert.subject);

<span class="hljs-comment">// create x509 certificate request</span>
<span class="hljs-keyword">let</span> pky = crypto.PKey.from(private_pem);
<span class="hljs-keyword">let</span> req = <span class="hljs-keyword">new</span> crypto.X509Req(<span class="hljs-string">"CN=localhost,O=fibjs"</span>, pky);
<span class="hljs-keyword">let</span> derReq = req.der();
<span class="hljs-keyword">let</span> pemReq = req.pem();
<span class="hljs-built_in">console</span>.log(pemReq);
</code></pre>
<p>以上示例代码通过 X509Cert 类读取了一个已有的 x509 证书，并输出了证书的主题名称 subject。同时，示例代码还演示了如何通过 X509Req 创建 x509 证书请求，并输出了 PEM 格式的请求信息。</p>
<h2 id="X509-模块的使用">X509 模块的使用</h2>
<h3 id="生成自签名证书">生成自签名证书</h3>
<p>生成自签名证书的过程比较简单，一般需要完成以下步骤：</p>
<ul>
<li>生成 PKey（私钥）</li>
<li>生成 X509Req（证书请求）</li>
<li>使用 X509Req 生成 X509Cert（正式证书）</li>
<li>保存证书</li>
</ul>
<p>通过这些步骤，可以自己生成一个用于测试和开发环境的 x509 证书。下面是具体的实现：</p>
<p>使用以下代码创建 PKey 对象。其中，from() 方法可以通过一个 PEM 格式的字符串或者一个 Buffer 来创建 PKey 对象。</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2</div><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto'</span>);
<span class="hljs-keyword">const</span> pky = crypto.PKey.from(private_pem);
</code></pre>
<p>使用以下代码创建 X509Req 对象。其中，X509Req 的第一个参数是主题可分辨名称（Subject Name），字符串格式为 key1=value1,key2=value2。第二个参数是先前创建的 PKey 对象，用于证书签名。例如：</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1</div><span class="hljs-keyword">let</span> xrq = <span class="hljs-keyword">new</span> crypto.X509Req(<span class="hljs-string">"CN=localhost,O=fibjs"</span>, pky);
</code></pre>
<p>使用以下代码创建 X509Cert（正式证书）。具体操作是调用 X509Req 的 sign() 方法，该方法接受三个参数：证书颁发机构的名称、用于签名的 PKey 对象、以及其他相关信息。例如，下列示例中，将 X509Req 对象签名为自签名证书，签名机构为本身，证书有效期为 10 年：</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5</div><span class="hljs-keyword">const</span> opt = {
  <span class="hljs-attr">notBefore</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(),
  <span class="hljs-attr">notAfter</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime() + <span class="hljs-number">10</span> * <span class="hljs-number">365</span> * <span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>)
};
<span class="hljs-keyword">const</span> cert = xrq.sign(<span class="hljs-string">"CN=localhost,O=fibjs"</span>, pky, opt);
</code></pre>
<p>使用以下代码将 PKey 和 X509Cert 保存到本地文件。由于证书是使用 PEM 格式保存的，因此可以使用 pem() 方法将证书对象转化为字符串，然后直接保存到文件中：</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5</div><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">const</span> ks = pky.pem();    <span class="hljs-comment">// export pem format data of the private key</span>
<span class="hljs-keyword">const</span> cs = cert.pem(); <span class="hljs-comment">// export pem format data of the cert</span>
fs.writeFile(<span class="hljs-string">'mycert.key'</span>, ks); <span class="hljs-comment">// save the key</span>
fs.writeFile(<span class="hljs-string">'mycert.pem'</span>, cs); <span class="hljs-comment">// save the cert</span>
</code></pre>
<p>以上代码完成了从生成私钥到存储自签名证书的整个过程。可以通过这个证书来测试和开发安全相关的应用程序。</p>
<h3 id="加载证书">加载证书</h3>
<p>加载证书是使用 x509 证书时的一项重要操作。下面介绍如何加载证书文件和加载公钥私钥。</p>
<p>为了使用 x509 证书，必须首先将证书文件读取到内存中，并将其转换为 x509 证书对象。以下是如何加载证书文件的步骤：</p>
<p>在 fibjs 的 JavaScript 程序中，可以使用 fs 模块的相关 API 来读取文件。例如，使用以下代码读取 PEM 格式的证书文件：</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2</div><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">const</span> certData = fs.readFile(<span class="hljs-string">'server.crt'</span>);
</code></pre>
<p>读取文件后，必须使用 X509Cert 对象将证书文件内容转换为 x509 证书：</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2</div><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto'</span>);
<span class="hljs-keyword">const</span> cert = <span class="hljs-keyword">new</span> crypto.X509Cert(certData);
</code></pre>
<p>经过以上步骤，可以加载本地的 x509 证书文件。也可以使用 crypto.loadCert 直接读取证书：</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2</div><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto'</span>);
<span class="hljs-keyword">const</span> cert = crypto.loadCert(<span class="hljs-string">'server.crt'</span>);
</code></pre>
<p>x509 证书中保存着公钥和加密后的签名信息，因此需要在使用证书时，将证书中的公钥解析出来，以方便对数据进行加密和解密。PKey 类可以将 PEM 格式的公钥/私钥字符串转换为公钥/私钥对象。可以使用以下代码读取 PEM 格式的公钥/私钥字符串，并创建 PKey 对象:</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2</div><span class="hljs-keyword">const</span> privateKey = fs.readFile(<span class="hljs-string">'private.pem'</span>); <span class="hljs-comment">// load the data from file</span>
<span class="hljs-keyword">const</span> pKey = crypto.PKey.from(privateKey); <span class="hljs-comment">// load from pem format data</span>
</code></pre>
<p>或者使用 crypto.loadPKey 直接读取：</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2</div><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto'</span>);
<span class="hljs-keyword">const</span> pKey = crypto.loadPKey(<span class="hljs-string">'private.pem'</span>);
</code></pre>
<p>经过以上步骤，可以将公钥/私钥文件转换为 PKey 对象。</p>
<h3 id="解析证书">解析证书</h3>
<p>证书是 SSL/TLS 交互中重要的组成部分，用于身份身份验证和数据传输的加密。现在，我们来了解如何在 fibjs 中解析一个证书。</p>
<p>我们可以使用 crypto 模块的 X509Cert 类，通过读取一个 DER/PEM 格式的证书文件构建一个证书对象，紧接着可以获取证书的一些基本信息，例如获取证书的主题名称、颁发者名称、有效期等等信息。</p>
<p>示例代码如下：</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7
8
9
10
11
12
13
14</div><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto'</span>);

<span class="hljs-keyword">const</span> cert = crypto.loadCert(<span class="hljs-string">'path/to/cert.pem'</span>);

<span class="hljs-keyword">const</span> subjectName = cert.subject;
<span class="hljs-keyword">const</span> issuerName = cert.issuer;
<span class="hljs-keyword">const</span> validFromDate = cert.notBefore;
<span class="hljs-keyword">const</span> expirationDate = cert.notAfter;
<span class="hljs-keyword">const</span> serialNumber = cert.serial;

<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`证书主题名称: <span class="hljs-subst">${subjectName}</span>`</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`证书颁发者名称: <span class="hljs-subst">${issuerName}</span>`</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`证书有效期: <span class="hljs-subst">${validFromDate.toLocaleString()}</span> ~ <span class="hljs-subst">${expirationDate.toLocaleString()}</span>`</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`证书序列号: <span class="hljs-subst">${serialNumber}</span>`</span>);
</code></pre>
<p>当需要使用一个证书时，我们需要验证这个证书的合法性，关键是要确定证书是由一个可信的组织颁发的。可以使用 X509Cert 中的 verify 方法来检查证书的合法性，常见的验证方式是通过验证证书的链，确保证书被受信任的 CA 颁发。</p>
<p>示例代码如下：</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7
8
9</div><span class="hljs-keyword">const</span> caCert = crypto.loadCert(<span class="hljs-string">'path/to/ca.crt'</span>);

<span class="hljs-keyword">const</span> verifyResult = cert.verify(caCert);

<span class="hljs-keyword">if</span> (verifyResult !== <span class="hljs-number">0</span>) {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'证书验证失败'</span>, verifyResult);
} <span class="hljs-keyword">else</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'证书验证通过'</span>);
}
</code></pre>
<p>在此示例代码中，我们首先读取指定的 CA 证书，生成一个 X509Cert 对象，接着使用证书对象上的 verify 方法验证需要验证的证书，并获取验证结果。你可以通过比较验证结果是否等于 0 来判断证书是否合法。如果验证结果不为 0，则说明验证失败，此时应当停止使用该证书。</p>
<h3 id="使用证书">使用证书</h3>
<p>在使用 https 服务器时，需要确保使用的证书已经添加到服务器上。以下是一个简单的示例，通过 crypto 模块加载证书和私钥文件：</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7
8
9
10</div><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);
<span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">"crypto"</span>);

<span class="hljs-keyword">const</span> cert = crypto.loadCert(<span class="hljs-string">"server.crt"</span>);
<span class="hljs-keyword">const</span> key = crypto.loadPKey(<span class="hljs-string">"server.key"</span>);

<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> http.HttpsServer(cert, key, <span class="hljs-number">8443</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req</span>) </span>{
    req.response.write(<span class="hljs-string">`Hello, fibjs!`</span>);
});
server.start();
</code></pre>
<p>在上面的示例中，我们通过 loadCert 和 loadPKey 函数加载了 server.crt 和 server.key 文件，然后使用 HttpsServer 对象创建了一个服务，并用加载的证书和密钥文件启动服务。</p>
<h2 id="X509-模块的注意事项">X509 模块的注意事项</h2>
<h3 id="证书的安全性">证书的安全性</h3>
<p>X509 模块提供了证书的创建、处理等功能，证书的安全性必须得到保障，这需要特别注意以下几点：</p>
<ul>
<li>私钥的安全性。私钥是证书的重要组成部分，必须得到严格保护。在证书的使用过程中，应该尽可能地将私钥存储在安全的地方，并合理设置访问权限。</li>
<li>证书的传输安全。在证书的交换和使用过程中，必须采用安全的传输方式，避免证书被窃取或篡改。</li>
<li>证书的验证安全。证书验证是确保证书有效和安全性的重要环节，必须严格按照证书的验证规则来进行验证，以避免伪造的证书误导使用者。</li>
</ul>
<h3 id="证书的有效期">证书的有效期</h3>
<p>证书的有效期是指从证书发行日期到证书过期日期之间的这段时间。证书的有效期限制了证书的使用时间，在证书过期之前，证书持有人可以使用证书，但在证书过期之后，证书将失去其有效性。</p>
<p>因此，在使用证书之前，必须先检查证书的有效期，以避免使用已经过期的证书。同时，在证书过期之前，应该尽早地更新证书，以确保证书的可用性。</p>
<h3 id="证书的信任机制">证书的信任机制</h3>
<p>证书的信任机制是证书能否被客户端或服务器端信任的关键因素。通常情况下，客户端或服务器端只信任由可信机构(CA)签发和承认的证书。</p>
<p>在使用证书之前，必须确定证书的信任问题。可以通过检查证书的颁发机构、证书的主题可分辨名称等方式来判断证书是否可信任。</p>
<h3 id="证书的更新机制">证书的更新机制</h3>
<p>证书的更新机制是确保证书一直有效并且安全的重要环节。通常情况下，证书的更新主要包括两个方面：</p>
<ul>
<li>证书过期后的更新。在证书过期后，必须重新申请证书，并按照相应的规则进行签名和验证，以确保证书的有效性。</li>
<li>证书扩展和更新。在证书的使用过程中，如果需要扩展或更新证书的信息，可以通过重新申请证书并进行签名和验证的方式来实现。</li>
</ul>
<p>综上所述，X509 模块提供了证书的创建、处理等功能，是确保证书安全、可信和有效的重要环节。在使用和管理证书的过程中，必须遵循相应的规则和要求，以确保证书的有效性和安全性。</p>
<p>👉 【<a href=contribute.md.html>添加 native 模块</a>】</p>
 </div><div class="sidebar hidden-sm hidden-xs hidden-md"><div id=toc></div></div></div></div><div class=footer><div class=container>&copy; Copyright 2012-2021 fibjs.org | <a href=../../support.html>支持我们</a></div></div><a id=back-to-top href=# class="btn btn-default btn-lg back-to-top" role=button title="" data-toggle=tooltip data-placement=left><span class="glyphicon glyphicon-chevron-up"></span></a><script type=text/javascript src=https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js></script><script type=text/javascript src=../../js/common.js></script><script type=text/javascript src=../../js/docs.js></script></body></html>